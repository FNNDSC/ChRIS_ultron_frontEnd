<!--
@license
Copyright (c) 2016 FNNDSC. All rights reserved.
-->

<!-- POLYMER -->
<link rel="import" href="../../bower_components/polymer/polymer.html">

<!-- PAPER -->
<link rel="import" href="../../bower_components/paper-input/paper-input.html">

<!-- CHRIS -->
<link rel="import" href="../chris-comment/chris-comment.html">

<!-- STYLE -->
<link rel="import" href="../chris-feed/chris-feed-styles.html">

<dom-module id="chris-comment-list">

  <template>

    <style include="chris-feed-styles"></style>
    <style>

    paper-input {
      var(--paper-grey-300);
    }

    </style>


      <!-- Toolbar -->
      <div class="section toolbar">
        <div class="title">Comments</div>
      </div>

      <div class="content">
        <template is="dom-repeat" items="[[comments]]">
          <chris-comment comment="[[item]]"></chris-comment>
        </template>
        <paper-input id="newcomment" label="Add a comment" on-keydown="checkForEnter" char-counter maxlength="120"></paper-input>
      </div>

  </template>

  <script>
    Polymer({
        is: 'chris-comment-list',

        properties: {

          comments: {
            type: Array
          }

        },

        checkForEnter: function ( evt ) {
          
          // check if 'enter' was pressed
          if (evt.keyCode === 13) {

            evt.stopPropagation();
            evt.preventDefault();

            //
            var comment = {
              name: "Nicolas Rannou",
              color: "blue",
              content: this.$.newcomment.value
            };
            this.$.newcomment.value = '';

            this.push('comments', comment);

            // let feed now that its size changed
            this.fire('resized-content');
            // add comment to list then push to server
            // if server returns an error, remove comment

            }

          }
    });
  </script>
</dom-module>
