<!--
@license
Copyright (c) 2016 FNNDSC. All rights reserved.
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../chris-feed/chris-feed.html">

<dom-module id="chris-feed-list">

  <template>

    <style>
        :host{
         position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    }

      iron-list {
        --iron-list-items-container: {
          max-width: 800px;
          margin: auto;
          margin-top: 60px;
          margin-bottom: 60px;
          border-bottom: 1px solid #ddd;
        };
      }

    </style>

    <iron-list id="feeds" items="[[feeds]]" as="feed" selection-enabled multi-selection  on-size="resizeItem" on-newfeed="newFeed" on-scrollto="scrollto">
        <template>
          <div>
          <chris-feed index="[[index]]" feed="[[feed]]" selected="[[selected]]"></chris-feed>
          </div>
        </template>
      </iron-list>

  </template>

  <script>
    Polymer({
        is: 'chris-feed-list',
        properties: {
          feeds: {
            type: Object
          }
        },
        attached: function() {
          this.$.feeds.scrollTarget = this.ownerDocument.documentElement;
        },
        resizeItem: function(evt){
          this.$.feeds.updateSizeForItem(evt.detail.index);
        },
        newFeed: function(evt){
          window.console.log('got a new feed');
          // get the feed content...
          var feed = {
            id: this.feeds.length + 1,
            name: 'pacs_pull' + (this.feeds.length + 1),
            image: 'https://s3.amazonaws.com/uifaces/faces/twitter/enda/73.jpg',
            opened: false,//this.response[i].expanded,
            color: 'rgb(134,91,60)',
            favorite: (this.feeds.length % 3) ? true : false,
            // status: ((this.response[i].zip < 20000) ? 'success' : (this.response[i].zip < 30000 ? 'running' : 'error')),
            description: "just created from plugin",
            fulldescription: "YAYAYAYAYAYAYYA",
            date: "Sun Aug 14 1994 03:27:03 GMT-0700 (PDT)"
          }

          this.unshift('feeds', feed);

          this.$.feeds.scrollToIndex(0);

        },
        scrollto: function(evt){
          window.console.log('got scrollto');
          window.console.log(evt);
          // this.$.feeds.scroll(evt.detail.offsetTop);

        }
    });
  </script>
</dom-module>
