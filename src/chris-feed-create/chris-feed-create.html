
      <!--
@license
Copyright (c) 2016 FNNDSC. All rights reserved.
-->


<link rel="import" href="../../bower_components/polymer/polymer.html">


<!-- APP LAYOUT -->
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">

<!-- IRON ELEMENTS -->
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icons/av-icons.html">
<link rel="import" href="../../bower_components/iron-icons/communication-icons.html">
<link rel="import" href="../../bower_components/iron-icons/social-icons.html">

<!-- STYLE -->
<link rel="import" href="../chris-ultron/chris-ultron-styles.html">

<dom-module id="chris-feed-create">

  <template>

    <style include="chris-ultron-styles"></style>
    <style>
    :host{
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
    }
    
    .container {
      position: fixed;
      height: 100vh;
      width: 100vw;
    }

    #card {
      position: relative;
      margin: 64px 100px 0;
      min-height: 100vh;
      /*height: 100%;*/
      background-color: var(--paper-grey-50);
    }

    .big {
      --iron-icon-height: 48px;
      --iron-icon-width: 48px;
      margin-right:24px;
    }

    paper-fab#gogogo {
        z-index:10;
        position: fixed;
        bottom: 16px;
        right: 16px;
      }
    </style>


                <app-header-layout>
        <app-header fixed effects="waterfall">
          <app-toolbar class$="primary {{plugin.color}}"> <div title> <iron-icon class="big" icon$="{{plugin.icon}}"></iron-icon> {{plugin.label}}</div>

          <paper-icon-button icon="close" alt="More options"></paper-icon-button>
          </app-toolbar>
        </app-header>



      <div id="container" class$="light container {{plugin.color}}">
      </div>
              <div id="card">
<!--               <app-toolbar class$="primary {{plugin.color}}"><iron-icon class="big" icon$="{{plugin.icon}}"></iron-icon> {{plugin.label}}</app-toolbar> -->
              
              
        </div>


            <!-- FABS? -->
            <!-- should be in the plugin page -->
            <paper-fab id="gogogo" icon="av:play-arrow" title="play-arrow" on-tap="gogogo"></paper-fab>

        </app-header-layout>
  </template>


  <script>
    Polymer({
        is: 'chris-feed-create',
        properties: {

          plugin: {
            type: Object,
            observer: '_pluginChanged'
          },

          feed:{
            type: Object
          }

        },
        _pluginChanged: function( ){

          // remove child if any
          var node = Polymer.dom(this.$.card).querySelector( '.plugin' );
          if( node ){

            Polymer.dom( this.$.card ).removeChild( node );

          }
          
          // fetch the plugin!
          var self = this;
          Polymer.Base.importHref(
            this.plugin.url,
            function( evt ){

              var plugin = document.createElement( self.plugin.name );
              plugin.classList.add( 'plugin' );
              Polymer.dom( self.$.card ).appendChild( plugin );

            },

            function( evt ){

              window.console.log( 'oops, something went wrong...' );
              window.console.log( evt );

            },
            true );
        },
        gogogo: function(){
          // feed created
          // ask for feed ID # through API...
          // call API to get feed
          // the create plugin should return it to us...
          this.feed = {
            id: 0,
            name: this.plugin.name,
            image: 'https://s3.amazonaws.com/uifaces/faces/twitter/enda/73.jpg',
            opened: false,//this.response[i].expanded,
            color: this.plugin.color,
            favorite: Math.round(Math.random() * 100) % 3 ? true : false,
            // status: ((this.response[i].zip < 20000) ? 'success' : (this.response[i].zip < 30000 ? 'running' : 'error')),
            description: "just created",
            fulldescription: "YAYAYAYAYAYAYYA",
            date: "Sun Aug 14 1994 03:27:03 GMT-0700 (PDT)"
          }

          this.fire('done');
        }
  });
  </script>
</dom-module>
