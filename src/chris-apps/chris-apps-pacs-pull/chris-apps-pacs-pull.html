<link rel="import" href="../../../bower_components/polymer/polymer.html">

<!-- IRON ELEMENTS -->
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../../bower_components/iron-pages/iron-pages.html">

<!-- PAPER ELEMENTS -->
<link rel="import" href="../../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../../bower_components/paper-tabs/paper-tab.html">

<!-- CHRIS ELEMENTS -->
<link rel="import" href="../chris-apps-behavior.html">

<!-- BASE ELEMENTS -->
<link rel="import" href="pacs-query.html">
<link rel="import" href="pacs-retrieve.html">

<!--
Chris app pacs-pull element!
@demo demo/index.html
-->

<dom-module id="chris-apps-pacs-pull">

  <template>

    <style>

      host {

        display: block;

      }

      paper-tabs {

        --paper-tabs-selection-bar-color: var(--accent-color);

      }

      paper-tab {

        --paper-tab-ink: var(--accent-color);

      }

    </style>

      <!-- Toolbar -->
      <div id="toolbar">
        <paper-tabs selected="{{selected}}">
          <paper-tab>Search</paper-tab>
          <paper-tab>Results ([[query.length]])</paper-tab>
        </paper-tabs>
      </div>

      <iron-pages selected="{{selected}}">

        <pacs-query query="{{query}}" on-query-changed="_queryChanged"></pacs-query>
        <pacs-retrieve query="[[query]]"></pacs-retrieve>

      </iron-pages>

  </template>

  <script>
    Polymer({
        is: 'chris-apps-pacs-pull',
        properties: {

          toolbar: HTMLElement,

          selected: {
            type: Number,
            value: 0
          },

          query: {
            type: Array,
            value: []
            //,
            // we do no use observer in the properties
            // because if so the callback is called at creation time.
            //observer: '_queryChanged'
          },

          parameters: {
            type: Object
          }

        },

        behaviors: [
          ChrisApps
        ],

        ready: function(){

          this.toolbar = this.$.toolbar;

        },

        // we do no use observer in the properties
        // because if so the callback is called at creation time.
        _queryChanged: function( value ){

          this.selected = 1;

        },

        generateParameters: function(){

          // get parameters
          //
          this.parameters = {
            hello: 'from',
            the: 'pacs_pull'
          }

          // let plugin-fs know the parameters are ready
          this.fire( 'parameters-changed' );

        }
    });
  </script>
</dom-module>