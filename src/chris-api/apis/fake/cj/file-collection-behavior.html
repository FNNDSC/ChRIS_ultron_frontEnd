<script>
  /** @polymerBehavior FileCollectionCJ */
  FileCollectionCJ = {

    generateFileCollectionCJ: function( feedid, parameters ){

      // create a collection of 1 for now....
      var cj = {};
      cj.collection = {};

      // create the href field
      cj.collection.href = this.apiRoot + '/' + feedid + '/files/';

      // create the template field
      cj.collection.template = {};
      cj.collection.template.data = this.fileTemplate();

      // create the items field
      cj.collection.items = [];

      var dicomFiles = this.filesCollectionRawData();
      dicomFiles.unshift('/data/pacsquery.json');
      var plugins = this.pluginsInstancesCollectionRawData( feedid );

      for( var i = 0; i < dicomFiles.length; i++ ){

        var item = {};
        item.href = this.apiRoot + '/' + feedid + '/files/' + i + '/';
        item.links = [{
            rel: 'file_resource',
            href: this.apiRoot + dicomFiles[i]
        }];
        var data = {
          fname: dicomFiles[i],
          plugin_instance: plugins[Math.floor(Math.random() * plugins.length)].id
        };

        item.data = this.generateItemDataCJ( cj.collection.template.data, data ).data;

        if( !parameters || !parameters.plugin_instance || parameters.plugin_instance === data.plugin_instance ){

          cj.collection.items.push( item );

        }

      }

      return cj;
    }

  }
</script>