<script>
  /** @polymerBehavior PluginCollection */
  PluginCollectionCJ = {

    /**
     */
    generatePluginCollectionCJ: function( ){

      var cj = {};
      cj.collection = {};

      // create the href field
      cj.collection.href = this.apiRoot + '/' + '<feedID>/plugins';

      // create the template field
      cj.collection.template = {};
      cj.collection.template.data = this.pluginTemplate();

      // create the items
      cj.collection.items = [];
      var items = cj.collection.items;

      // generate random number of items
      var plugins = this.generateFakeFlatPlugins( 3 );

      for( var i=0; i<plugins.length; i++ ){

        var item = {};
        //create the href field (will miss the feed id but OK)
        item.href = this.apiRoot + '/<feedID>/plugins/' + i;

        // create the links field
        item.links = [];

        item.data = this.generateItemDataCJ( cj.collection.template.data, plugins[i] ).data;
        items.push(item);

      }

      return cj;

    },

    generateFakeFlatPlugins: function( maxDepth ){

      var plugins = [];
      plugins.push( this.generatePlugin( null, 0, 0 ) );

      var leaves = this.rGenerateFlatPlugins( plugins[0], 1, maxDepth );
      plugins.push.apply( plugins, leaves );

      return plugins;

    },

    rGenerateFlatPlugins: function( parent, depth, maxDepth ){

      // random number of leaves between 0 and 3
      var nbLeaves = Math.floor( Math.random( ) * 3 );
      if(!nbLeaves){
        return;
      }

      var leaves = [];


      for( var i = 0; i<nbLeaves; i++ ){

        // generate leave
        var leave = this.generatePlugin( parent, i, depth );
        leaves.push( leave );

        if( depth <= maxDepth ){
          var child = this.rGenerateFlatPlugins( leave, depth + 1, maxDepth );
          leaves.push.apply( leaves, child );
        }

      }

      return leaves;

    },

  }
</script>