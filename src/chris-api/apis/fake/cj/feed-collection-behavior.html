<script>
  /** @polymerBehavior FeedCollectionCJ */
  FeedCollectionCJ = {

    /**
     */
    generateFeedCollectionCJ: function( rawDataCollection, parameters ){

      var cj = {};
      cj.collection = {};

      // create the href field
      cj.collection.href = this.apiRoot + '/feeds';

      // create the template field
      cj.collection.template = {};
      cj.collection.template.data = this.feedTemplate();

      // create the items
      cj.collection.items = [];
      var items = cj.collection.items;

      for( var i=0; i<rawDataCollection.length; i++ ){

        var item = {};
        // create the href field
        item.href = this.apiRoot + '/' + rawDataCollection[i].index;

        // create the links
        item.links = [];
        item.links.push( {
          'rel' : 'note',
          'href' : this.apiRoot + '/note/' + rawDataCollection[i].index + '/'
        });
        item.links.push( {
          'rel' : 'comments',
          'href' : this.apiRoot + '/' + rawDataCollection[i].index + '/comments/'
        });
        item.links.push( {
          'rel' : 'tags',
          'href' : this.apiRoot + '/' + rawDataCollection[i].index + '/tags/'
        });
        item.links.push( {
          'rel' : 'files',
          'href' : this.apiRoot + '/' + rawDataCollection[i].index + '/files/'
        });

        var data = this.generateFeedRawData( rawDataCollection[i] );

        // hack to filter out results
        var skip = 0;

        for(var j=0; j< data.tags.length; j++){
          
          if( parameters.filter && parameters.filter.indexOf( data.tags[j].name ) >= 0){
            skip += 1;
          }

        }

        if( skip === parameters.filter.length ){
          item.data = this.generateItemDataCJ( cj.collection.template.data, data ).data;
          items.push(item);
        }

      }

      return cj;

    }

  }
</script>