<link rel="import" href="cj/helper-behavior.html">
<link rel="import" href="cj/comment-collection-behavior.html">
<link rel="import" href="cj/comment-behavior.html">
<link rel="import" href="cj/feed-collection-behavior.html">
<link rel="import" href="cj/feed-behavior.html">
<link rel="import" href="cj/label-collection-behavior.html">
<link rel="import" href="cj/label-behavior.html">
<link rel="import" href="cj/note-behavior.html">
<link rel="import" href="cj/pacsquery-behavior.html">
<link rel="import" href="cj/plugin-collection-behavior.html">
<link rel="import" href="cj/plugin-behavior.html">

<script>
    /** @polymerBehavior FakeAPI */
    // extending behaviors
    // https://www.polymer-project.org/1.0/docs/devguide/behaviors
    FakeAPI = [
      HelperCJ,
      CommentCollectionCJ,
      CommentCJ,
      FeedCollectionCJ,
      FeedCJ,
      LabelCollectionCJ,
      LabelCJ,
      NoteCJ,
      PacsqueryCJ,
      PluginCollectionCJ,
      PluginCJ
    ]

    FakeAPIImpl = {

      urlFakeAPI: function( target ){

        // POST AND PUT
        if( this.method !== 'GET'){
          return 'https://httpbin.org/' + this.method.toLowerCase();;
        }

        // GET      
        // url pattern: /<number>/ to be replaced by /feed/
        var isFeedRegex = /^\/(\d+)\//;
        if( isFeedRegex.test(target) ){
          target = target.replace(isFeedRegex, '/feed/');
        }

        return 'data/' + target + '.json';

      },

      formatFakeAPIResponse: function(target, params, response){

        switch( target ){
          case 'login':
            return {
              status: true,
              message: 'Successful login.',
              token: 'kjASD12dasS'
            };
          default:
            // to nothing yet.
            break;
        }

        //
        var itemCJ = {};

        // Simulate GET
        if( this.method === 'GET' && target === 'comments' ){

          itemCJ = this.generateCommentCollectionCJ();

        }
        else if( this.method === 'GET' && target === 'feeds' ){

          itemCJ = this.generateFeedCollectionCJ( response.data, params );

        }
        else if( this.method === 'GET' && target === 'labels' ){

          itemCJ = this.generateLabelCollectionCJ();

        }
        else if( this.method === 'GET' && target === 'note' ){

          itemCJ = this.generateNoteCJ();

        }
        else if( this.method === 'GET' && target === 'plugins' ){

          itemCJ = this.generatePluginCollectionCJ();

        }

        // Simulate POST/PUT
        if( this.method !== 'GET' ){

          itemCJ.collection = {};
          itemCJ.collection.href = target;

        }

        // Generate errors...
        if( this.apiError ){

          itemCJ.collection.error = {
            'title'   : 'API Error',
            'code'    : 'X1234',
            'message' : this.method + ' : ' + itemCJ.collection.href + ' could not be processed.'
          };

        }

        return itemCJ;
      }

    },

    FakeAPI.push(FakeAPIImpl)

</script>
