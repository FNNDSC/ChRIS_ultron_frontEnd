<!--
@license
Copyright (c) 2016 FNNDSC. All rights reserved.
-->

<link rel="import" href="../../../bower_components/polymer/polymer.html">

<!-- IRON ELEMENTS -->
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../../bower_components/iron-list/iron-list.html">

<!-- PAPER ELEMENTS -->
<!-- <link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html"> -->
<!-- <link rel="import" href="../../bower_components/paper-material/paper-material.html"> -->

<link rel="import" href="../chris-feed/chris-feed.html">

<dom-module id="chris-feed-list">

  <template>

    <style>

      :host {

        display: block;

      }

      iron-list {

        padding-top: 16px;
        padding-bottom: 64px;
        --iron-list-items-container: {
          max-width: 800px;
          margin: auto;
          margin-top: 30px;
          margin-bottom: 60px;
          border-bottom: 1px solid var(--accent-color);
        };

      }

      a {
        color: inherit;
      }

    </style>

    <iron-list id="feeds" items="[[feeds.data]]" as="feed" selection-enabled on-resize-feed="resizeFeed" scroll-target="[[scrollTarget]]">

      <template>

        <a href="/detail/{{index}}/">

          <chris-feed index="[[index]]" feed="[[feed]]" on-tap="_showDetails"></chris-feed>

        </a>


      </template>
      
    </iron-list>


  </template>

  <script>
    Polymer({
        is: 'chris-feed-list',
        properties: {

          feeds: {
            type: Array
          },

          feedOpened: {
            type: Object
          },

          scrollTarget: HTMLElement

        },

        resizeFeed: function( event ){

          this.$.feeds.updateSizeForItem( event.detail.index );

        },

        _showDetails: function( event ){
          
          // attach to event instead of linking?
          this.set( 'feedOpened', event.model.__data__.feed );
          this.fire( 'feed-opened-changed', event.model.__data__.feed );

        }

    });
  </script>
</dom-module>
