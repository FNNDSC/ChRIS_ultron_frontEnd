<!doctype html>

<html>
  <head>
    <title>chris-label-list test</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
    <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../../web-component-tester/browser.js"></script>

    <link rel="import" href="../../src/chris-label-list/chris-label-list.html">
  </head>
  <body>

    <test-fixture id="basic">
      <template>
        <chris-label-list></chris-label-list>
      </template>
    </test-fixture>

    <script>
      suite( '<chris-label-list>', function() {

        let element;

        setup(function(){

          element = fixture('basic');

        });

        test('instantiating the element works', function() {

          assert.equal( element.is, 'chris-label-list' );

        });

        // CHRIS LABELS
        test('selects all when select all and nothing selected', function( done ){

          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="all"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'all' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('selects all when select all and something selected', function( done ){

          element.$.labels.selectedValues = ['favorite', 'running'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="all"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'all' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('deselect all when select favorite', function( done ){

          element.$.labels.selectedValues = ['all'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="favorite"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'favorite' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('deselect favorite and select all when deselect favorite', function( done ){

          element.$.labels.selectedValues = ['favorite'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="favorite"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'all' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('deselect all when select running', function( done ){

          element.$.labels.selectedValues = ['all'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="running"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'running' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('do not deselect favorite when select running', function( done ){

          element.$.labels.selectedValues = ['favorite'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="running"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 2 );
            assert.equal( element.filter[0], 'running' );
            assert.equal( element.filter[1], 'favorite' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('do not deselect running when deselect favorite', function( done ){

          element.$.labels.selectedValues = ['favorite', 'running'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="favorite"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'running' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('deselect running when select done', function( done ){

          element.$.labels.selectedValues = ['running'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="done"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'done' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        test('deselect done when select error', function( done ){

          element.$.labels.selectedValues = ['done'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="error"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'error' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });


        test('deselect error when select running', function( done ){

          element.$.labels.selectedValues = ['error'];
          element.addEventListener( 'filter-changed', filterChanged );

          // select all
          element.$.labels.querySelector('paper-icon-item[value="running"]').click();

          function filterChanged( event ) {

            // not logged in
            assert.equal( element.filter.length, 1 );
            assert.equal( element.filter[0], 'running' );

            done();
            element.removeEventListener( 'filter-changed', filterChanged );

          }

        });

        // CUSTOM LABELS
        // test('select custom label', function( done ){

        //   element.customLabels = [{
        //     color: 'red',
        //     value: 'red'
        //   }];

        //   element.addEventListener( 'custom-filter-changed', customFilterChanged );

        //   // select all
        //   element.$.customLabels.querySelector('#custom-red').click();

        //   function customFilterChanged( event ) {

        //     // not logged in
        //     assert.equal( element.customFilter.length, 1 );
        //     assert.equal( element.customFilter[0], 'red' );

        //     done();
        //     element.removeEventListener( 'custom-filter-changed', customFilterChanged );

        //   }

        // });

      } );
    </script>

  </body>
</html>
