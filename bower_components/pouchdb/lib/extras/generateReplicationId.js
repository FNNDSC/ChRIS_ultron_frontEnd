"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e["default"]:e}function binaryMd5(e,t){var r=crypto.createHash("md5").update(e,"binary").digest("base64");t(r)}function sortObjectPropertiesByKey(e){return Object.keys(e).sort(pouchdbCollate.collate).reduce(function(t,r){return t[r]=e[r],t},{})}function generateReplicationId(e,t,r){var o=r.doc_ids?r.doc_ids.sort(pouchdbCollate.collate):"",i=r.filter?r.filter.toString():"",n="",c="";return r.filter&&r.query_params&&(n=JSON.stringify(sortObjectPropertiesByKey(r.query_params))),r.filter&&"_view"===r.filter&&(c=r.view.toString()),PouchPromise.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+i+c+n+o;return new PouchPromise(function(e){binaryMd5(t,e)})}).then(function(e){return e=e.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+e})}var lie=_interopDefault(require("lie")),crypto=_interopDefault(require("crypto")),pouchdbCollate=require("pouchdb-collate"),PouchPromise="function"==typeof Promise?Promise:lie;module.exports=generateReplicationId;