"use strict";function createDeepMultiMapper(e,r){return function(a){for(var t=[],n=0,i=e.length;i>n;n++){for(var p=parseField(e[n]),c=a,l=0,o=p.length;o>l;l++){var u=p[l];if(c=c[u],!c)break}t.push(c)}r(t)}}function createDeepSingleMapper(e,r){var a=parseField(e);return function(e){for(var t=e,n=0,i=a.length;i>n;n++){var p=a[n];if(t=t[p],!t)return}r(t)}}function createShallowSingleMapper(e,r){return function(a){r(a[e])}}function createShallowMultiMapper(e,r){return function(a){for(var t=[],n=0,i=e.length;i>n;n++)t.push(a[e[n]]);r(t)}}function checkShallow(e){for(var r=0,a=e.length;a>r;r++){var t=e[r];if(-1!==t.indexOf("."))return!1}return!0}function createMapper(e,r){var a=checkShallow(e),t=1===e.length;return a?t?createShallowSingleMapper(e[0],r):createShallowMultiMapper(e,r):t?createDeepSingleMapper(e[0],r):createDeepMultiMapper(e,r)}function mapper(e,r){var a=Object.keys(e.fields);return createMapper(a,r)}function reducer(){throw new Error("reduce not supported")}function ddocValidator(e,r){var a=e.views[r];if(!a.map||!a.map.fields)throw new Error("ddoc "+e._id+" with view "+r+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}var localUtils=require("./utils"),abstractMapReduce=require("../../abstract-mapreduce"),parseField=localUtils.parseField,abstractMapper=abstractMapReduce({name:"indexes",mapper:mapper,reducer:reducer,ddocValidator:ddocValidator});module.exports=abstractMapper;