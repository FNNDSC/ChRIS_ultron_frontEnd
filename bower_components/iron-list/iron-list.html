<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">



</head><body><dom-module id="iron-list">
  <template>
    <style>:host{display:block;}:host(.has-scroller){overflow:auto;}:host(:not(.has-scroller)){position:relative;}#items{@apply (--iron-list-items-container);position:relative;}#items > ::content > *{width:100%;box-sizing:border-box;position:absolute;top:0;will-change:transform;}</style>

    <array-selector id="selector" items="{{items}}" selected="{{selectedItems}}" selected-item="{{selectedItem}}">
    </array-selector>

    <div id="items">
      <content></content>
    </div>

  </template>
</dom-module>

<script>!function(){var t=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),i=t&&t[1]>=8,e=3,s=500;Polymer({is:"iron-list",properties:{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},selectedAs:{type:String,value:"selected"},selectionEnabled:{type:Boolean,value:!1},selectedItem:{type:Object,notify:!0},selectedItems:{type:Object,notify:!0},multiSelection:{type:Boolean,value:!1}},observers:["_itemsChanged(items.*)","_selectionEnabledChanged(selectionEnabled)","_multiSelectionChanged(multiSelection)"],behaviors:[Polymer.Templatizer,Polymer.IronResizableBehavior],listeners:{"iron-resize":"_resizeHandler"},_ratio:.5,_scroller:null,_scrollerPaddingTop:0,_scrollPosition:0,_physicalCount:0,_physicalStart:0,_physicalEnd:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_virtualStartVal:0,_physicalIndexForKey:null,_estScrollHeight:0,_scrollHeight:0,_viewportSize:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_collection:null,_itemsRendered:!1,_lastPage:null,_maxPages:3,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportSize},get _virtualEnd(){return this._virtualStartVal+this._physicalCount-1},_minVirtualStart:0,get _maxVirtualStart(){return Math.max(0,this._virtualCount-this._physicalCount)},get _hiddenContentSize(){return this._physicalSize-this._viewportSize},get _maxScrollTop(){return this._estScrollHeight-this._viewportSize},set _virtualStart(t){this._virtualStartVal=Math.min(this._maxVirtualStart,Math.max(this._minVirtualStart,t)),this._physicalStart=this._virtualStartVal%this._physicalCount,this._physicalEnd=(this._physicalStart+this._physicalCount-1)%this._physicalCount},get _virtualStart(){return this._virtualStartVal},get _optPhysicalSize(){return this._viewportSize*this._maxPages},get _isVisible(){return this._scroller&&Boolean(this._scroller.offsetWidth||this._scroller.offsetHeight)},get firstVisibleIndex(){var t;return null===this._firstVisibleIndexVal&&(t=this._physicalTop,this._firstVisibleIndexVal=this._iterateItems(function(i,e){return t+=this._physicalSizes[i],t>this._scrollPosition?e:void 0})||0),this._firstVisibleIndexVal},ready:function(){i?this._scrollListener=function(){requestAnimationFrame(this._scrollHandler.bind(this))}.bind(this):this._scrollListener=this._scrollHandler.bind(this)},attached:function(){var t=Polymer.dom(this),e=t.parentNode;e&&e.scroller?this._scroller=e.scroller:(this._scroller=this,this.classList.add("has-scroller")),i&&(this._scroller.style.webkitOverflowScrolling="touch"),this._scroller.addEventListener("scroll",this._scrollListener),this.updateViewportBoundaries(),this._render()},detached:function(){this._itemsRendered=!1,this._scroller&&this._scroller.removeEventListener("scroll",this._scrollListener)},updateViewportBoundaries:function(){var t=window.getComputedStyle(this._scroller);this._scrollerPaddingTop=parseInt(t["padding-top"],10),this._viewportSize=this._scroller.offsetHeight},_refresh:function(){var t,i,e,s,h,l=Math.max(0,Math.min(this._maxScrollTop,this._scroller.scrollTop)),r=this._ratio,a=l-this._scrollPosition,o=0,n=this._hiddenContentSize,c=r,_=[];if(this._scrollPosition=l,this._firstVisibleIndexVal=null,s=this._scrollBottom,h=this._physicalBottom,Math.abs(a)>this._physicalSize)this._physicalTop+=a,o=Math.round(a/this._physicalAverage);else if(0>a){var u=l-this._physicalTop,p=this._virtualStart;for(e=[],i=this._physicalEnd,c=u/n;r>c&&o<this._physicalCount&&p-o>0&&h-this._physicalSizes[i]>s;)t=this._physicalSizes[i],c+=t/n,h-=t,e.push(i),o++,i=0===i?this._physicalCount-1:i-1;_=e,o=-o}else if(a>0){var d=h-s,y=this._virtualEnd,m=this._virtualCount-1;for(e=[],i=this._physicalStart,c=d/n;r>c&&o<this._physicalCount&&m>y+o&&this._physicalTop+this._physicalSizes[i]<l;)t=this._physicalSizes[i],c+=t/n,this._physicalTop+=t,e.push(i),o++,i=(i+1)%this._physicalCount}0===o?(s>h||this._physicalTop>l)&&this.async(this._increasePool.bind(this,1)):(this._virtualStart=this._virtualStart+o,this._update(e,_))},_update:function(t,i){if(this._assignModels(t),this._updateMetrics(t),i)for(;i.length;)this._physicalTop-=this._physicalSizes[i.pop()];this._positionItems(),this._updateScrollerSize(),this._increasePoolIfNeeded()},_createPool:function(t){var i=new Array(t);this._ensureTemplatized();for(var e=0;t>e;e++){var s=this.stamp(null);i[e]=s.root.querySelector("*"),Polymer.dom(this).appendChild(s.root)}return i},_increasePoolIfNeeded:function(){if(0!==this._viewportSize&&this._physicalSize<this._optPhysicalSize){var t=Math.floor(this._physicalSize/this._viewportSize);return 0===t?this.async(this._increasePool.bind(this,Math.round(.5*this._physicalCount))):this._lastPage!==t?requestAnimationFrame(this._increasePool.bind(this,1)):this.async(this._increasePool.bind(this,1)),this._lastPage=t,!0}return!1},_increasePool:function(t){var i=Math.min(this._physicalCount+t,this._virtualCount,s),e=this._physicalCount,h=i-e;return h>0?([].push.apply(this._physicalItems,this._createPool(h)),[].push.apply(this._physicalSizes,new Array(h)),this._physicalCount=e+h,this._update()):void 0},_render:function(){var t=this._virtualCount>0||this._physicalCount>0;this.isAttached&&!this._itemsRendered&&this._isVisible&&t&&(this._lastPage=0,this._update(),this._itemsRendered=!0)},_ensureTemplatized:function(){if(!this.ctor){var t={};t.__key__=!0,t[this.as]=!0,t[this.indexAs]=!0,t[this.selectedAs]=!0,this._instanceProps=t,this._userTemplate=Polymer.dom(this).querySelector("template"),this._userTemplate?this.templatize(this._userTemplate):console.warn("iron-list requires a template to be provided in light-dom")}},_getStampedChildren:function(){return this._physicalItems},_forwardInstancePath:function(t,i,e){0===i.indexOf(this.as+".")&&this.notifyPath("items."+t.__key__+"."+i.slice(this.as.length+1),e)},_forwardParentProp:function(t,i){this._physicalItems&&this._physicalItems.forEach(function(e){e._templateInstance[t]=i},this)},_forwardParentPath:function(t,i){this._physicalItems&&this._physicalItems.forEach(function(e){e._templateInstance.notifyPath(t,i,!0)},this)},_forwardItemPath:function(t,i){if(this._physicalIndexForKey){var e=t.indexOf("."),s=t.substring(0,0>e?t.length:e),h=this._physicalIndexForKey[s],l=this._physicalItems[h];if(l){var r=l._templateInstance;e>=0?(t=this.as+"."+t.substring(e+1),r.notifyPath(t,i,!0)):r[this.as]=i}}},_itemsChanged:function(t){"items"===t.path?(this._itemsRendered=!1,this._virtualStartVal=0,this._physicalTop=0,this._virtualCount=this.items?this.items.length:0,this._collection=this.items?Polymer.Collection.get(this.items):null,this._physicalIndexForKey={},this._resetScrollPosition(0),this._physicalItems||(this._physicalCount=Math.max(1,Math.min(e,this._virtualCount)),this._physicalItems=this._createPool(this._physicalCount),this._physicalSizes=new Array(this._physicalCount)),this.debounce("refresh",this._render)):"items.splices"===t.path?(this._itemsRendered=!1,this._adjustVirtualIndex(t.value.indexSplices),this._virtualCount=this.items?this.items.length:0,this.debounce("refresh",this._render)):this._forwardItemPath(t.path.split(".").slice(1).join("."),t.value)},_adjustVirtualIndex:function(t){var i,e,s;for(i=0;i<t.length&&(e=t[i],e.removed.forEach(this.$.selector.deselect,this.$.selector),s=e.index,!(s>=this._virtualStartVal));i++)this._virtualStart=this._virtualStart+Math.max(e.addedCount-e.removed.length,s-this._virtualStartVal)},_scrollHandler:function(){this._refresh()},_iterateItems:function(t,i){var e,s,h,l;if(2===arguments.length&&i){for(l=0;l<i.length;l++)if(e=i[l],s=e>=this._physicalStart?this._virtualStartVal+(e-this._physicalStart):this._virtualStartVal+(this._physicalCount-this._physicalStart)+e,null!=(h=t.call(this,e,s)))return h}else{for(e=this._physicalStart,s=this._virtualStartVal;e<this._physicalCount;e++,s++)if(null!=(h=t.call(this,e,s)))return h;for(e=0;e<this._physicalStart;e++,s++)if(null!=(h=t.call(this,e,s)))return h}},_assignModels:function(t){this._iterateItems(function(t,i){var e=this._physicalItems[t],s=e._templateInstance,h=this.items&&this.items[i];h?(s[this.as]=h,s.__key__=this._collection.getKey(h),s[this.selectedAs]=this.$.selector.isSelected(h),s[this.indexAs]=i,e.removeAttribute("hidden"),this._physicalIndexForKey[s.__key__]=t):(s.__key__=null,e.setAttribute("hidden",""))},t)},_updateMetrics:function(t){var i=0,e=0,s=this._physicalAverageCount,h=this._physicalAverage;Polymer.dom.flush(),this._iterateItems(function(t,s){e+=this._physicalSizes[t]||0,this._physicalSizes[t]=this._physicalItems[t].offsetHeight,i+=this._physicalSizes[t],this._physicalAverageCount+=this._physicalSizes[t]?1:0},t),this._physicalSize=this._physicalSize+i-e,this._viewportSize=this._scroller.offsetHeight,this._physicalAverageCount!==s&&(this._physicalAverage=Math.round((h*s+i)/this._physicalAverageCount))},_positionItems:function(){this._adjustScrollPosition();var t=this._physicalTop;this._iterateItems(function(i){this.transform("translate3d(0, "+t+"px, 0)",this._physicalItems[i]),t+=this._physicalSizes[i]})},_adjustScrollPosition:function(){var t=0===this._virtualStartVal?this._physicalTop:Math.min(this._scrollPosition+this._physicalTop,0);t&&(this._physicalTop=this._physicalTop-t,i||this._resetScrollPosition(this._scroller.scrollTop-t))},_resetScrollPosition:function(t){this._scroller&&(this._scroller.scrollTop=t,this._scrollPosition=this._scroller.scrollTop)},_updateScrollerSize:function(t){this._estScrollHeight=this._physicalBottom+Math.max(this._virtualCount-this._physicalCount-this._virtualStartVal,0)*this._physicalAverage,t=t||0===this._scrollHeight,t=t||this._scrollPosition>=this._estScrollHeight-this._physicalSize,(t||Math.abs(this._estScrollHeight-this._scrollHeight)>=this._optPhysicalSize)&&(this.$.items.style.height=this._estScrollHeight+"px",this._scrollHeight=this._estScrollHeight)},scrollToIndex:function(t){if("number"==typeof t){this.firstVisibleIndex;t=Math.min(Math.max(t,0),this._virtualCount-1),this._virtualStart=t-1,this._assignModels(),this._updateMetrics(),this._physicalTop=this._virtualStart*this._physicalAverage;for(var i=this._physicalStart,e=this._virtualStart,s=0,h=this._hiddenContentSize;t>e&&h>s;)s+=this._physicalSizes[i],i=(i+1)%this._physicalCount,e++;this._updateScrollerSize(!0),this._positionItems(),this._resetScrollPosition(this._physicalTop+s+1),this._increasePoolIfNeeded(),this._firstVisibleIndexVal=null}},_resetAverage:function(){this._physicalAverage=0,this._physicalAverageCount=0},_resizeHandler:function(){this.debounce("resize",function(){this._render(),this._itemsRendered&&this._physicalItems&&this._isVisible&&(this._resetAverage(),this.updateViewportBoundaries(),this.scrollToIndex(this.firstVisibleIndex))})},_getModelFromItem:function(t){var i=this._collection.getKey(t),e=this._physicalIndexForKey[i];return void 0!==e?this._physicalItems[e]._templateInstance:null},_getNormalizedItem:function(t){if("number"==typeof t){if(t=this.items[t],!t)throw new RangeError("<item> not found")}else if(void 0===this._collection.getKey(t))throw new TypeError("<item> should be a valid item");return t},selectItem:function(t){t=this._getNormalizedItem(t);var i=this._getModelFromItem(t);!this.multiSelection&&this.selectedItem&&this.deselectItem(this.selectedItem),i&&(i[this.selectedAs]=!0),this.$.selector.select(t)},deselectItem:function(t){t=this._getNormalizedItem(t);var i=this._getModelFromItem(t);i&&(i[this.selectedAs]=!1),this.$.selector.deselect(t)},toggleSelectionForItem:function(t){t=this._getNormalizedItem(t),this.$.selector.isSelected(t)?this.deselectItem(t):this.selectItem(t)},clearSelection:function(){function t(t){var i=this._getModelFromItem(t);i&&(i[this.selectedAs]=!1)}Array.isArray(this.selectedItems)?this.selectedItems.forEach(t,this):this.selectedItem&&t.call(this,this.selectedItem),this.$.selector.clearSelection()},_selectionEnabledChanged:function(t){t?(this.listen(this,"tap","_selectionHandler"),this.listen(this,"keypress","_selectionHandler")):(this.unlisten(this,"tap","_selectionHandler"),this.unlisten(this,"keypress","_selectionHandler"))},_selectionHandler:function(t){if("keypress"!==t.type||13===t.keyCode){var i=this.modelForElement(t.target);i&&this.toggleSelectionForItem(i[this.as])}},_multiSelectionChanged:function(t){this.clearSelection(),this.$.selector.multi=t},updateSizeForItem:function(t){t=this._getNormalizedItem(t);var i=this._collection.getKey(t),e=this._physicalIndexForKey[i];void 0!==e&&(this._updateMetrics([e]),this._positionItems())}})}();</script>
</body></html>