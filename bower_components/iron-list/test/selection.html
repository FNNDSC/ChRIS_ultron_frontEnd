<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>iron-list test</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">

  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../web-component-tester/browser.js"></script>
  <script src="../../iron-test-helpers/mock-interactions.js"></script>

  <link rel="import" href="helpers.html">
  <link rel="import" href="x-list.html">

</head>
<body>

  <test-fixture id="trivialList">
    <template>
      <x-list item-height="10"></x-list>
    </template>
  </test-fixture>

  <script>suite("selection",function(){var e,t;setup(function(){t=fixture("trivialList"),e=t.list}),test("single selection by item index",function(t){e.items=buildDataSet(100),flush(function(){assert.isNull(e.selectedItem),e.selectItem(0),assert.deepEqual(e.selectedItem,e.items[0]),e.deselectItem(0),assert.deepEqual(e.selectedItem,null),e.selectItem(99),assert.deepEqual(e.selectedItem,e.items[99]),t()})}),test("single selection by item object",function(t){e.items=buildDataSet(100),flush(function(){assert.isNull(e.selectedItem),e.selectItem(e.items[50]),assert.deepEqual(e.selectedItem,e.items[50]),t()})}),test("multi selection by item index",function(t){e.items=buildDataSet(100),flush(function(){e.multiSelection=!0,assert.isArray(e.selectedItems),e.selectItem(0),e.selectItem(50),e.selectItem(99),assert.equal(e.selectedItems.length,3),assert.notEqual(e.selectedItems.indexOf(e.items[0]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[50]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[99]),-1),assert.equal(e.selectedItems.indexOf(e.items[2]),-1),t()})}),test("multi selection by item object",function(t){e.items=buildDataSet(100),flush(function(){e.multiSelection=!0,assert.isArray(e.selectedItems),e.selectItem(e.items[0]),e.selectItem(e.items[50]),e.selectItem(e.items[99]),assert.equal(e.selectedItems.length,3),assert.notEqual(e.selectedItems.indexOf(e.items[0]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[50]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[99]),-1),assert.equal(e.selectedItems.indexOf(e.items[2]),-1),t()})}),test("clear selection",function(t){e.items=buildDataSet(100),flush(function(){e.multiSelection=!0,assert.isArray(e.selectedItems),e.items.forEach(function(t){e.selectItem(t)}),assert.equal(e.selectedItems.length,e.items.length),e.clearSelection(),assert.equal(e.selectedItems.length,0),t()})}),test("toggle selection by item index",function(t){e.items=buildDataSet(100),flush(function(){e.toggleSelectionForItem(0),assert.deepEqual(e.selectedItem,e.items[0]),e.toggleSelectionForItem(0),assert.isNull(e.selectedItem),t()})}),test("toggle selection by item object",function(t){e.items=buildDataSet(100),flush(function(){e.toggleSelectionForItem(e.items[0]),assert.deepEqual(e.selectedItem,e.items[0]),e.toggleSelectionForItem(e.items[0]),assert.isNull(e.selectedItem),t()})}),test("change multi property",function(t){e.items=buildDataSet(100),flush(function(){e.multiSelection=!0,assert.isArray(e.selectedItems),e.multiSelection=!1,assert.isNotArray(e.selectedItems),assert.isNull(e.selectedItems),e.multiSelection=!0,assert.isArray(e.selectedItems),t()})}),test("selectionEnabled with single selection",function(t){e.items=buildDataSet(100),flush(function(){e.selectionEnabled=!0,assert.isNull(e.selectedItem),MockInteractions.tap(e._physicalItems[0]),assert.deepEqual(e.selectedItem,e.items[0]),MockInteractions.tap(e._physicalItems[5]),MockInteractions.tap(e._physicalItems[1]),assert.deepEqual(e.selectedItem,e.items[1]),t()})}),test("selectionEnabled with multiple selection",function(t){e.items=buildDataSet(100),flush(function(){e.multiSelection=!0,MockInteractions.tap(e._physicalItems[0]),assert.equal(e.selectedItems.length,0),e.selectionEnabled=!0,MockInteractions.tap(e._physicalItems[0]),assert.notEqual(e.selectedItems.indexOf(e.items[0]),-1),MockInteractions.tap(e._physicalItems[1]),MockInteractions.tap(e._physicalItems[5]),MockInteractions.tap(e._physicalItems[10]),MockInteractions.tap(e._physicalItems[12]),e.selectItem(0),e.deselectItem(1),assert.equal(e.selectedItems.indexOf(e.items[1]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[0]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[5]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[10]),-1),assert.notEqual(e.selectedItems.indexOf(e.items[12]),-1),e.clearSelection(),assert.equal(e.selectedItems.length,0),e.selectionEnabled=!1,MockInteractions.tap(e._physicalItems[1]),assert.equal(e.selectedItems.length,0),t()})}),test("toggle",function(t){e.items=buildDataSet(100),flush(function(){e.selectionEnabled=!0,MockInteractions.tap(e._physicalItems[0]),assert.deepEqual(e.selectedItem,e.items[0]),MockInteractions.tap(e._physicalItems[0]),assert.isNull(e.selectedItem),MockInteractions.tap(e._physicalItems[0]),e.clearSelection(),assert.isNull(e.selectedItem),t()})}),test("selectedAs",function(t){e.items=buildDataSet(100),flush(function(){e.multiSelection=!0,assert.isFalse(e._physicalItems[0]._templateInstance.selected),e.selectItem(0),assert.isTrue(e._physicalItems[0]._templateInstance.selected),e.toggleSelectionForItem(0),assert.isFalse(e._physicalItems[0]._templateInstance.selected),e.multiSelection=!1,e.selectItem(0),e.selectItem(10),assert.isFalse(e._physicalItems[0]._templateInstance.selected),assert.isTrue(e._physicalItems[10]._templateInstance.selected),t()})}),test("splice a selected item",function(t){e.items=buildDataSet(100),flush(function(){e.multiSelection=!0,e.selectItem(0),e.selectItem(1),assert.equal(e.selectedItems.length,2),e.splice("items",0,2),assert.equal(e.selectedItems.length,0),t()})}),test("single selection of a primitive type",function(){e.primitive=!0,e.items=["a","b","c","d"],e.selectionEnabled=!0,Polymer.dom.flush(),e.selectItem(0),assert.equal(e.selectedItem,"a","single selection 1"),e.clearSelection(),assert.isNull(e.selectedItem),e.selectItem(2),e.set("items.0","z"),e.set("items.1","y"),assert.equal(e.selectedItem,"c","single selection 2")}),test("multi selection of a primitive types",function(){e.primitive=!0,e.items=["a","b","c","d"],e.selectionEnabled=!0,e.multiSelection=!0,Polymer.dom.flush(),e.selectItem(0),e.selectItem(1),assert.deepEqual(e.selectedItems,["a","b"],"multiple selection 1"),e.clearSelection(),assert.equal(e.selectedItems.length,0,"multiple selection 2")}),test("modify primitive item while being selected",function(){e.primitive=!0,e.items=["a","b","c","d"],e.selectionEnabled=!0,Polymer.dom.flush(),e.selectItem(0),e.set("items.0","z"),assert.equal(e.selectedItem,"z","single selection 1"),e.selectItem(2),assert.equal(e.selectedItem,"c","single selection 2"),e.clearSelection(),assert.isNull(e.selectedItem),e.multiSelection=!0,e.selectItem(0),e.selectItem(1),assert.deepEqual(e.selectedItems,["z","b"],"multiple selection 1"),e.set("items.1","y"),assert.deepEqual(e.selectedItems,["z","y"],"multiple selection 2"),e.deselectItem("y"),assert.deepEqual(e.selectedItems,["z"],"multiple selection 3"),e.deselectItem("z"),assert.equal(e.selectedItems.length,0)}),test("tapping on a focusable child should not change the selection",function(){e.items=buildDataSet(1),e.selectionEnabled=!0,Polymer.dom.flush();var t=document.createElement("div");t.innerText="focusable",t.tabIndex=0,Polymer.dom(getFirstItemFromList(e)).appendChild(t),Polymer.dom.flush(),t.focus(),MockInteractions.tap(t),assert.isNull(e.selectedItem)})});</script>



</body></html>