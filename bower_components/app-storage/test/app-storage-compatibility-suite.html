<html><head><script>!function(){"use strict";function t(t){function e(t,e){return t.transactionsComplete.then(function(){return r.fetchStoredValue(t.memoryPathToStoragePath(e),t)})}var r={tagName:"unknown-element",awaitUpdate:function(){return Promise.resolve()},fetchStoredValue:function(){return Promise.resolve()},unsetValue:function(t){return t.set("data",null),t.transactionsComplete}};Object.assign(r,t),suite("app storage compatibility: <"+r.tagName+">",function(){suite("basic storage scenarios",function(){var t;setup(function(){return t=fixture("BasicStorage"),t.set("data",{}),t.transactionsComplete}),teardown(function(){return r.unsetValue(t)}),suite("setting properties",function(){test("sets primitive values",function(){return t.set("data.numberProperty",1),e(t,"data.numberProperty").then(function(t){expect(t).to.be.equal(1)})}),test("sets object values",function(){return t.set("data.objectProperty",{foo:1}),e(t,"data.objectProperty").then(function(t){expect(t).to.be.eql({foo:1})})}),test("sets array values",function(){return t.set("data.arrayProperty",[1,2,3]),e(t,"data.arrayProperty").then(function(t){expect(t).to.be.eql([1,2,3])})})}),suite("updating properties",function(){test("updates primitive values",function(){return t.set("data.numberProperty",1),e(t,"data.numberProperty").then(function(r){return t.set("data.numberProperty",2),e(t,"data.numberProperty")}).then(function(t){expect(t).to.be.eql(2)})}),test("updates object values",function(){return t.set("data.objectProperty",{foo:1}),e(t,"data.objectProperty").then(function(r){return t.set("data.objectProperty.bar",2),e(t,"data.objectProperty")}).then(function(t){expect(t).to.be.eql({foo:1,bar:2})})}),test("updates array values",function(){return t.set("data.arrayProperty",[1,2,3]),e(t,"data.arrayProperty").then(function(r){return t.set("data.arrayProperty",[1,2,3,4]),e(t,"data.arrayProperty")}).then(function(t){expect(t).to.be.eql([1,2,3,4])})}),suite("manipulating arrays",function(){setup(function(){return t.set("data.arrayProperty",[1,2,3]),e(t,"data.arrayProperty").then(function(t){expect(t).to.be.eql([1,2,3])})}),test("updates after array push",function(){return t.push("data.arrayProperty",4),e(t,"data.arrayProperty").then(function(t){expect(t).to.be.eql([1,2,3,4])})}),test("updates after array pop",function(){return t.pop("data.arrayProperty"),e(t,"data.arrayProperty").then(function(t){expect(t).to.be.eql([1,2])})}),test("updates after additive array splice",function(){return t.splice("data.arrayProperty",1,0,4),e(t,"data.arrayProperty").then(function(t){expect(t).to.be.eql([1,4,2,3])})}),test("updates after subtractive array splice",function(){return t.splice("data.arrayProperty",1,1),e(t,"data.arrayProperty").then(function(t){expect(t).to.be.eql([1,3])})}),test("updates after complex array splice",function(){return t.splice("data.arrayProperty",1,1,4),e(t,"data.arrayProperty").then(function(t){expect(t).to.be.eql([1,4,3])})})})}),suite("removing properties",function(){test("removes primitive values",function(){return t.set("data.numberProperty",1),e(t,"data.numberProperty").then(function(){return t.set("data.numberProperty",null),e(t,"data.numberProperty")}).then(function(t){expect(t).to.not.be.ok})}),test("removes object values",function(){return t.set("data.objectProperty",{foo:1,bar:2}),e(t,"data.objectProperty").then(function(){return t.set("data.objectProperty.bar",null),e(t,"data.objectProperty")}).then(function(t){expect(t.foo).to.be.ok,expect(t.bar).to.not.be.ok})}),test("removes array values",function(){return t.set("data.arrayProperty",[1,2,3]),e(t,"data.arrayProperty").then(function(){return t.pop("data.arrayProperty"),e(t,"data.arrayProperty")}).then(function(t){expect(t).to.be.eql([1,2])})})})}),suite("syncing storage scenarios",function(){var t,a;setup(function(){var e=fixture("SyncingStorage");return t=e[0],a=e[1],Promise.all([t.transactionsComplete,a.transactionsComplete])}),teardown(function(){return r.unsetValue(t),r.awaitUpdate(a).then(function(){expect(a.data).to.be.eql(t.data)})}),test("syncs primitives across elements",function(){return t.set("data.numberProperty",1),Promise.all([e(t,"data.numberProperty"),r.awaitUpdate(a)]).then(function(e){var r=e[0];expect(r).to.be.equal(1),expect(t.get("data.numberProperty")).to.be.equal(r),expect(a.get("data.numberProperty")).to.be.equal(r)})}),test("syncs object values across elements",function(){var n={foo:1};return t.set("data.objectProperty",n),Promise.all([e(t,"data.objectProperty.foo"),r.awaitUpdate(a)]).then(function(e){var r=e[0];expect(r).to.be.equal(1),expect(t.get("data.objectProperty")).to.be.eql(n),expect(a.get("data.objectProperty")).to.be.eql(n)})}),test("syncs array values across elements",function(){var n=[1,2,3];return t.set("data.arrayProperty",n),Promise.all([e(t,"data.arrayProperty.0"),r.awaitUpdate(a)]).then(function(e){var r=e[0];expect(r).to.be.equal(1),expect(t.get("data.arrayProperty")).to.be.eql(n),expect(a.get("data.arrayProperty")).to.be.eql(n)})})})})}window.testAppStorageDocumentCompatibility=t}();</script>
</head><body></body></html>